# Fly.io configuration for Ampel Background Worker
# Documentation: https://fly.io/docs/reference/configuration/

app = "ampel-worker"
primary_region = "iad"  # Ashburn, Virginia (change if needed)

# Build configuration
[build]
  dockerfile = "docker/Dockerfile.worker"

# Environment variables (non-sensitive)
# Secrets (DATABASE_URL, REDIS_URL, ENCRYPTION_KEY) set via `fly secrets set`
[env]
  RUST_LOG = "info"
  RUST_BACKTRACE = "1"
  WORKER_CONCURRENCY = "10"

# No HTTP service for worker (internal only)
# Worker communicates via 6PN private network

# VM resources
[[vm]]
  size = "shared-cpu-1x"
  memory = "512mb"

# Process configuration
[processes]
  worker = "/app/ampel-worker"
